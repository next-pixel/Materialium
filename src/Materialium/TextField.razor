@using Microsoft.JSInterop
@inject IJSRuntime jsRuntime

<div ref="elem" class="@Classes()">
    @ChildContent
</div>

@functions {

        private string Classes()
        {
            List<string> classes = new List<string> { "mdc-text-field" };

            if (TextArea)
            {
                classes.Add("mdc-text-field--textarea");
            }

            if (Outlined)
            {
                classes.Add("mdc-text-field--outlined");
            }

            if (FullWidth)
            {
                classes.Add("mdc-text-field--fullwidth");
            }

            if (WithLeadingIcon)
            {
                classes.Add("mdc-text-field--with-leading-icon");
            }

            if (WithTrailingIcon)
            {
                classes.Add("mdc-text-field--with-trailing-icon");
            }

#pragma warning disable CS0618
            if (Dense)
            {
                classes.Add("mdc-text-field--dense");
            }
#pragma warning enable CS0618

            if (Focused)
            {
                classes.Add("mdc-text-field--focused");
            }
            if (NoLabel)
            {
                classes.Add("mdc-text-field--no-label");
            }
            if (Disabled)
            {
                classes.Add("mdc-text-field--disabled");
            }

            if (!string.IsNullOrWhiteSpace(Class))
            {
                classes.Add(Class);
            }

            return string.Join(" ", classes);
        }

    [Parameter]
    RenderFragment ChildContent { get; set; }

    [Parameter]
    bool Outlined { get; set; } = true;

    [Parameter]
    bool FullWidth { get; set; }

    [Parameter]
    bool WithLeadingIcon { get; set; }

    [Parameter]
    bool WithTrailingIcon { get; set; }

    [Parameter]
    bool TextArea { get; set; }


    [Parameter]
    bool Disabled { get; set; }

    [Obsolete("The --dense variant of the text field will be removed in an upcoming release. See https://github.com/material-components/material-components-web/issues/4142 for details.")]
    [Parameter]
    bool Dense { get; set; }

    [Parameter]
    bool Focused { get; set; }

    [Parameter]
    bool NoLabel { get; set; }

    [Parameter]
    string Class { get; set; }

    ElementRef elem;
    bool isFirstRender = true;

    protected override async Task OnAfterRenderAsync()
    {
        if (isFirstRender)
        {
            isFirstRender = false;
            await jsRuntime.InvokeAsync<object>("Materialium.textField.init", elem);
        }
    }
}